\documentclass[a4paper,11pt]{article}
\usepackage{fullpage}
\usepackage{standalone}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{mathptmx}
\usepackage{natbib}
\usepackage[final,babel]{microtype}
\usepackage[hidelinks]{hyperref}
\usepackage{doi}
\usepackage{siunitx}
\usepackage[margin=3pt]{subcaption}
\usepackage{xcolor}
\PassOptionsToPackage{final}{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{patterns}
\usepackage{bm}
\usepackage{booktabs}
\usepackage{tabularx}

\title{Monitoring Committee Progress Report \#3\\
\vspace*{1em}
\Large{Numerical Representation of Mountains in Atmospheric Models}}
\author{James Shaw
\vspace{0.5em} \\
\large{Supervisors: Hilary Weller, John Methven, Terry Davies}
\vspace{0.5em} \\
\large{Monitoring Committee: Maarten Ambaum, Paul Williams}}
\date{31st May 2016}

\captionsetup{margin=3pt,font={small}}

\makeatletter
\AtBeginDocument{
  \hypersetup{
    pdftitle = {Monitoring Committee Progress Report \#3},
    pdfauthor = {James Shaw}
  }
}
\makeatother


\newcommand{\TODO}[1]{\textcolor{purple}{TODO: \emph{#1}}}
\begin{document}
\newcommand{\exner}{\Pi}
\maketitle

Atmospheric models solve the equations of motion in a discrete form on a three-dimensional mesh, with the lower boundary representing the terrain surface.
Next-generation atmospheric models are being designed to be more flexible than previous models, so that the choice of mesh and choices of numerical schemes can be deferred or changed during operation \citep{ford2013,theurich2015}.
My PhD project seeks to make numerical weather and climate predictions more accurate by developing new meshes and numerical schemes that are suitable for next-generation models.
The project focuses on two aspects: first, how to model atmospheric flows accurately on arbitrary meshes and, second, how terrain is best represented by a mesh.

% let's follow the same order: first talk about advection accuracy

There are two main mesh generation methods used in atmospheric models: terrain-following layers and cut cells.
Most operational models use terrain-following layers, in which the vertical coordinate is transformed so that the mesh's lower boundary represents the terrain.
Terrain-following coordinates reduce numerical accuracy in the calculation of horizontal pressure gradients \citep{gary1973,zaengl2012} and advection terms \citep{schaer2002}.  Inaccuracies are larger near steep terrain.  Since the basic terrain-following coordinate was developed by \citet{galchen-somerville1975a}, there have been proposals to make coordinate transformations that are more orthogonal \citep{simmons-burridge1981,schaer2002,leuenberger2010,klemp2011}.

The cut cell method is an alternative to terrain-following coordinates.  Cut cell meshes are orthogonal everywhere except at the surface so that pressure gradient errors and advection errors are reduced, especially near steep terrain \citep{lock2012,good2014}.  While the cut cell method can reduce numerical errors, cut cell meshes can have arbitrarily small cells which impose severe constraints on the timestep for explicit methods \citep{almgren1997}.

To illustrate the two different mesh generation methods, a wave-shaped mountain is represented using a basic terrain-following mesh (figure~\ref{fig:btf-mesh}) and a cut cell mesh (figure~\ref{fig:cutcell-mesh}).  \TODO{say something about them}

\begin{figure}
	\centering
	\subcaptionbox{Basic terrain-following mesh \label{fig:btf-mesh}}[.32\linewidth]{\includegraphics[width=2in]{../thermalAdvection-mesh-btf-1000m-250dz/constant/mesh.pdf}}
	\subcaptionbox{Cut cell mesh \label{fig:cutcell-mesh}}[.32\linewidth]{\includegraphics[width=2in]{../thermalAdvection-mesh-cutCell-1000m-250dz/constant/mesh.pdf}}
	\subcaptionbox{Slanted cell mesh \label{fig:slantedcell-mesh}}[.32\linewidth]{\includegraphics[width=2in]{../thermalAdvection-mesh-slantedCell-1000m-250dz/constant/mesh.pdf}}
	\caption{Cell edges of basic terrain-following, cut cell and slanted cell meshes having the same wave-shaped mountain profile.  Only the lowest \SI{1.2}{\kilo\meter} in the centre of the domain is shown.  The entire domain is \SI{300}{\kilo\meter} wide and \SI{30}{\kilo\meter} high.  Axis units are \si{\meter}.  Cut cell mesh generated with code kindly provided by TROPOS.}
	\label{fig:meshes}
\end{figure}

\section{Comparison of terrain-following and slanted cell meshes}
The first year of my PhD concentrated on comparing the numerical accuracy on terrain-following and slanted cell meshes.
In the second monitoring committee report (called MC2 hereafter), the slanted cell method was referred to as the cut cell method, but it is necessary to make a distinction between the two methods: cut cell and slanted cell meshes have differences that can be seen by comparing the representation of the same terrain profile using cut cells (figure~\ref{fig:cutcell-mesh}) and slanted cells (figure~\ref{fig:slantedcell-mesh}).

The slanted cell method has advantages over the cut cell method.  First, unlike the construction of cut cell meshes, which can be somewhat involved \citep{hartkopf2011}, I have developed a new technique that makes slanted cell meshes straightforward to construct \citep{shaw-weller2016}.  Second, the slanted cell method does not severely constrain the timestep because thin cells are created that are long in the direction of flow.

Since the previous meeting, the Leibniz Institute for Tropospheric Research (TROPOS) have kindly provided me with their cut cell mesh generator used in the All Scale Atmospheric Model \citep{jaehn2015}.  This generates true cut cell meshes and will enable me to compare test results for cut cell and slanted cell meshes.

Our submission to Monthly Weather Review underwent a third round of revisions after our previous monitoring committee meeting.  These revisions included the development of a new slanted cell mesh generation method which avoided the complex heuristics employed by the previous method (see MC2, section 3).  The article was accepted for publication in February 2016 and is now undergoing prepress proofing.

\section{Improving advection on slanted cell meshes}
My current work focuses on improving the stability and accuracy of a multidimensional advection scheme that is suitable for arbitrary meshes \citep{weller-shahrokhi2014}.  The performance of the advection scheme is being evaluated over steep slopes on terrain-following, cut cell and slanted cell meshes.

The multidimensional advection scheme is an explicit, Eulerian, finite-volume scheme that has a cubic upwind-biased stencil.  Fluxes across faces are approximated using a least squares polynomial fit onto the stencil point values.
On a two-dimensional quadrilateral mesh, the stencil has $4 \times 3$ points in the domain interior (figure~\ref{fig:stencil-interior}), but may include fewer points near the boundaries.  This is a particular concern at the lower boundary where stencils may be smaller and highly distorted (figure~\ref{fig:stencil-lower-boundary}).

\begin{figure}
	\centering
	\subcaptionbox{Interior stencil \label{fig:stencil-interior}}[.48\linewidth]{\TODO{A $3 \times 4$ stencil on a quadrilateral mesh for a face in the domain interior}}
	\subcaptionbox{Lower boundary stencil \label{fig:stencil-lower-boundary}}[.48\linewidth]{\TODO{A $m \times n$ stencil for a face near the lower boundary of a slanted cell mesh}}
	\caption{\TODO{Two-dimensional cubicUpwindCPCFit stencils}}
	\label{fig:stencils}
\end{figure}

In the interior of a two-dimensional domain, we fit a polynomial surface to a stencil of a discrete scalar field $\phi$:
\begin{align}
	\phi = a_1 + a_2 x + a_3 y + a_4 x^2 + a_5 x y + a_6 y^2 + a_7 x^3 + a_8 x^2 y + a_9 x y^2
\end{align}
where $a_1 \ldots a_9$ are the unknown coefficients that are calculated from the least squares fit.  It may not be possible to fit all the polynomial terms to a stencil near the lower boundary because it will include fewer points that may be non-uniformly distributed.  With help from Philip Browne, I have developed a mathematical technique that removes certain high-order terms based on the stencil geometry.  We call this technique an `adaptive polynomial fit'.

The adaptive polynomial fit alone is not enough to ensure numerical stability.  I am developing a new procedure that will stabilise the polynomial fit for troublesome stencils.  It is based on constraints derived from a one-dimensional von Neumann analysis of a simplified version of the spatial discretisation.  Compared to the original version of the advection scheme by \citet{weller-shahrokhi2014}, the improved version is stable for a wider range of test cases and has accuracy that is comparable to the original version.  Further work is needed to achieve stability for additional test cases, and give us confidence that the scheme is stable and accurate for arbitrary meshes.

% I could talk about recent work in 1D, potential comparisons with WENO

\section{Future research}
\TODO{introductory sentence}

The development of the multidimensional advection scheme, as with most tasks in life, has proved to be more challenging than initially thought.  The new version of the scheme is already much improved over the original version since it is stable for a larger selection of tests.  However, the scheme is weakly unstable in certain cases and it is not yet clear how to address this issue.  I am collaborating with Tristan Pryer here at Reading, and I am reaching out to other experts in the field for further suggestions.

MC2 discussed exploratory work into a Charney--Phillips staggering for arbitrary meshes.  I intend to return to this topic once I am satisfied with the performance of the advection scheme and once I have prepared a paper discussing the advection results.

% say more about C--P: what needs doing? defining the variables, designing a advection schemes for theta, incorporating it into the fully-compressible model, 

% timescales?

\section{Training}
\TODO{quick overview of what's new: MA3NAT, MWR reviewer, DCMIP 2016, Simon Clark}

\subsection*{Mathematics modules}
\begin{tabular}{l l l l}
Spring 2016	& MA3NAT & Numerical Analysis II & unassessed \\
Spring 2015	& MAMNSP & Numerical Solution of Partial Differential Equations  & 78\% \\
\end{tabular}

\subsection*{RRDP modules}
\begin{tabular}{l l}
24 Mar 2016	& Voice coaching: looking after your voice \\
26--27 Jan 2016 & Preparing to teach (introduction, marking \& feedback, leading small groups) \\
2 Dec 2015	& An essential guide to critical academic writing \\
17 Nov 2015	& Understanding the UK higher education context \\
19 May 2015	& How to avoid plagiarism \\
10 Mar 2015	& How to write a literature review \\
19 Feb 2015	& How to write a paper \\
\end{tabular}

\subsection*{External courses}
\begin{tabular}{l l}
June 2016 & Dynamical core intercomparison project summer school, NCAR \\
13 May 2016 & Peer review: the nuts and bolts, Sense about Science \\
June 2015 & Advanced numerical methods for Earth-system modelling, ECMWF \\
\end{tabular}

\subsection*{Conferences and workshops}
\begin{tabularx}{\linewidth}{l l X}
October 2016 & Speaker & Numerical and computational methods for simulation of all-scale geophysical flows, ECMWF \\
July 2016 & Attendee & \TODO{1st GungHo Network meeting, Daresbury Laboratory} \\
November 2015 & Attendee & GungHo workshop on next generation weather and climate prediction, UK Met Office \\
June 2015 & Attendee & Hoskins@70 \\
June 2015 & Poster & SCENARIO DTP conference \\
March 2015 & Speaker & Galerkin methods with applications in weather and climate forecasting, ICMS \\
\end{tabularx}

\subsection*{Presentations}
\begin{tabularx}{\linewidth}{l l X}
23 Mar 2016 & Quo Vadis & Numerical representation of orography in dynamical cores \\
17 Feb 2016 & PhD group & Multidimensional advection schemes for arbitrary meshes \\
9 Feb 2016 & Mesoscale group & Curl-free pressure gradients for accurate modelling of cold air pools \\
19 Oct 2015 & HHH group & Improving modelled mountain flows with alternative representations of terrain \\
27 Apr 2015 & HHH group & A like-for-like comparison between terrain following and cut cell grids \\
21 Apr 2015 & PhD group & Discrete vector calculus on Arakawa C grids \\
12 Feb 2015 & UK Met office & Poster presentation \\
18 Jan 2015 & PhD group & Python and linux tips \\
17 Dec 2014 & MPECDT jamboree & Poster presentation \\
12 Sep 2014 & Lunchtime seminar  & Gain control of your documents and code: hands-on with revision control and build automation \\
\end{tabularx}

\subsection*{Teaching}
\begin{tabular}{l l l}
Oct 2015 & Teaching assistant & MTMG02 atmospheric physics \\
Sep 2015 & Teaching assistant & NCAS summer school \\
Sep 2014 & Course teacher & MPE python and linux short course \\
\end{tabular}

\subsection*{Outreach}
\begin{tabular}{l l l}
14 Jul 2015 & Schools physicist of the year awards \\
14 Jun 2015 & East Reading festival \\
15 Feb 2015 & Brighton science festival \\
\end{tabular}

\subsection*{Collaborations}
I have spent some time working with other contacts, sharing ideas about my own and their own research projects:
\begin{itemize}
\item Ram Nair has helped me to arrange a visit to NCAR in June 2016 to present my research and spend time with NCAR staff
\item I am arranging for Simon Clark to visit the department in July 2016.  Simon is a PhD student at Exeter and a YouTube vlogger.  I am organising for him to present a departmental seminar, and to film a radiosonde launch and laboratory demonstrations.
\item I have provided test cases and manuscript reviews for an article about dimensionally-split and multidimensional advection schemes.  I am a coauthor for this article, written with Hilary, her former student Yumeng Chen, and Stephen Pring at the UK Met Office.
\item I intend to collaborate with Hilary's next student, Christiana Skea, who will be investigating variable timestepping for ODEs
\item An OpenFOAM contributor, Mattijs Janssens, is helping us implement periodic boundary conditions for the multidimensional advection scheme.  I am also working with him to fix MPI parallelisation bugs in our code.
\end{itemize}

\bibliographystyle{ametsoc2014}                                                 
\small{\bibliography{references}}

\end{document}
